<html>
<head>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
	<script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBoF5rofkhCxeljdPT-bVBJJ84Gp-rcKhQ">
    </script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
	<link rel="stylesheet" href="style.css" />
	<title>jQuery Example</title>
	<script>
			function initialize() {
			console.log("Map initialization happening")
        var mapOptions = {
          center: { lat: 42.473369, lng: -83.221873},
          zoom: 10,
          draggable: false

        };
        var map = new google.maps.Map(document.getElementById('map-canvas'),
            mapOptions);
        
       	var places = [
  ['Callahans', 42.620471,-83.245066, 1,'images/music.png'],
  ['Magic Stick', 42.351162,-83.05991, 2,'images/music.png'],
  ['Royal Oak Music Theatre',42.48734,-83.147408, 3,'images/music.png'],
  ['The Book Beat', 42.4803193,-83.266704, 4,'images/book.png'],
  ['Berkley Book Corner',42.4854656,-83.2580983, 5,'images/book.png'],
  ['Spitzers Hebrew Books & Gifts', 42.4854656,-83.2580983, 6,'images/book.png']

];

        setMarkers(map,places);
 function setMarkers(map, locations) {
  // Add markers to the map

  // Marker sizes are expressed as a Size of X,Y
  // where the origin of the image (0,0) is located
  // in the top left of the image.

  // Origins, anchor positions and coordinates of the marker
  // increase in the X direction to the right and in
  // the Y direction down.
 
  // Shapes define the clickable region of the icon.
  // The type defines an HTML &lt;area&gt; element 'poly' which
  // traces out a polygon as a series of X,Y points. The final
  // coordinate closes the poly by connecting to the first
  // coordinate.
  
  
  for (var i = 0; i < locations.length; i++) {
    var venue = locations[i];
    var myLatLng = new google.maps.LatLng(venue[1], venue[2]);
    var marker = new google.maps.Marker({
        position: myLatLng,
        map: map,
        icon: venue[4],
        title: venue[0],
        zIndex: venue[3]
    });
   }
  }
}

      
      google.maps.event.addDomListener(window, 'load', initialize);


			$(document).ready(function() {
				var categoryData = [];

				var formData = {category: "food",location:"Detroit"}

				var getYelp = function getYelp(){
					console.log("GETTING YELP")
					  $.ajax({
					      url: "yelp.php",
					      type: "post",
					      data: formData,
					      datatype: 'json',
					      success: function(data){
					      		console.log("LAT: "+data.location.coordinate.latitude)     
					      },
					      error:function(){
					          console.log("ERROR JERK OFF");
					      }   
					}); 
				}
				var cBack = function updateStatusCallback(){
					FB.getLoginStatus(function(response) {
						if (response.status === 'connected') {
							// the user is logged in and has authenticated your
							// app, and response.authResponse supplies
							// the user's ID, a valid access token, a signed
							// request, and the time the access token 
							// and signed request each expire
							var uid = response.authResponse.userID;
							var accessToken = response.authResponse.accessToken;
							FB.api('/me/likes?limit=200&fields=category', function(response) {
								$.each(response.data,function(i,val){
									if($.inArray(val.category,categoryData) == -1){
										categoryData.push(val.category);
										$("#category-list").append("<li>"+val.category+"</li>");
									}
								})
		 					});

		 					getYelp();
						} else if (response.status === 'not_authorized') {
							// the user is logged in to Facebook, 
							// but has not authenticated your app
							FB.login(function(response) {
								if (response.authResponse) {
		 							alert('Welcome!  Fetching your information.... ');
	 							} else {
		 							alert('User cancelled login or did not fully authorize.');
	 							}
 							},{scope: 'email,user_likes'});
						} else {
							// the user isn't logged in to Facebook.
							alert("Not Logged In")
						}
					});
				}
				$.ajaxSetup({ cache: true });
				$.getScript('http://connect.facebook.net/en_UK/all.js', function(){
				FB.init({
					appId: '431061247042841',
					cookie     : true,
					xfbml      : true,
					version    : 'v2.1',
					status     : true,
				});
		$('#loginbutton,#feedbutton').removeAttr('disabled');
				FB.getLoginStatus(cBack);
		});
});

</script>
</head>
<body>
    <div class="jumbotron">
      <div class="container">
        <h1>Your Neighborhood</h1>
        <p>We know your neighborhood. See what's near you.</p>
      </div>
    </div>

	<div class="container">
		<div class="row">
			<div class="col-md-3"><ul id="category-list"></ul></div>
			<div class="col-md-9">
				<p>Here are the recommended places in the area:</p>
	<div id="map-container">
		<div id="map-canvas"></div>
	</div>
			</div>
		</div>
	</div>
</body>
</html>